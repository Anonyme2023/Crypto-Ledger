<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Retrait Cryptomonnaie Intelligent</title>
<script src="https://kit.fontawesome.com/093708b09e.js" crossorigin="anonymous"></script>
<style>
/* BODY & BACKGROUND */
body {
    margin:0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: url('https://london-post.co.uk/wp-content/uploads/2024/04/IMG_2136.jpeg') no-repeat center center/cover;
    color:#fff;
}
body::before {
    content:'';
    position:fixed; top:0; left:0;
    width:100%; height:100%;
    background-color:rgba(0,0,0,0.6);
    z-index:0;
}

/* MENU FIXE */
.menu {
    position:fixed; top:0; width:100%; background: rgba(0,0,0,0.7);
    backdrop-filter: blur(8px); display:flex; justify-content:center; padding:10px 0; z-index:10;
}
.menu ul { list-style:none; margin:0; padding:0; display:flex; flex-wrap:wrap; }
.menu ul li { margin:0 15px; }
.menu ul li a { color:#fff; text-decoration:none; font-weight:500; font-size:1.1em; transition: color 0.3s, transform 0.2s; }
.menu ul li a:hover { color:#f2a900; transform:scale(1.05); }

/* HEADER */
h1 { text-align:center; margin-top:80px; font-size:28px; color:#f2a900; }

/* FORMULAIRE RETRAIT */
#withdraw-form {
    max-width:600px; margin:20px auto; background: rgba(0,0,0,0.5);
    padding:20px; border-radius:16px; backdrop-filter: blur(8px); box-shadow:0 6px 20px rgba(0,0,0,0.5);
}
#withdraw-form div { margin-bottom:15px; }
#withdraw-form label { display:block; margin-bottom:5px; color:#f2a900; font-weight:bold; }
#withdraw-form input, #withdraw-form select {
    width:100%; padding:10px; border-radius:8px; border:none; font-size:1em;
}
#withdraw-form button {
    margin-top:10px; padding:10px; width:100%;
    border:none; border-radius:8px; font-weight:bold; background:#f2a900; color:#000; cursor:pointer;
    transition: 0.3s;
}
#withdraw-form button:hover { background:#ffcc33; }

/* FACTURE RETRAIT */
.facture {
    max-width:600px; margin:20px auto; background: rgba(0,0,0,0.5);
    padding:20px; border-radius:16px; backdrop-filter: blur(8px); box-shadow:0 6px 20px rgba(0,0,0,0.5);
}
.facture h2 { text-align:center; color:#f2a900; margin-bottom:20px; }
.info p, .details p { margin:8px 0; font-size:1em; }
.details p span { font-weight:bold; }
.payment-method { display:flex; align-items:center; gap:10px; margin-top:5px; }
.payment-method img { width:50px; height:auto; border-radius:8px; }
.footer { text-align:center; margin-top:15px; font-style:italic; color:#ddd; }

/* MINI CHATBOT */
#chatbot {
    position:fixed; bottom:20px; right:20px; width:300px; max-height:400px;
    background: rgba(0,0,0,0.8); border-radius:16px; padding:10px; display:flex; flex-direction:column; z-index:20;
}
#chatbot .messages { flex:1; overflow-y:auto; padding:5px; }
#chatbot .messages p { margin:5px 0; }
#chatbot input { padding:8px; border-radius:8px; border:none; margin-top:5px; width:100%; }
#chatbot button { padding:8px; margin-top:5px; border:none; border-radius:8px; background:#f2a900; color:#000; cursor:pointer; font-weight:bold; }
</style>
</head>
<body>

<!-- MENU -->
<div class="menu">
    <ul>
        <li><a href="dashboard.html">Tableau de Bord</a></li>
        <li><a href="verification.html">Vérification</a></li>
        <li><a href="depot.html">Dépôt</a></li>
        <li><a href="retrait.html">Retrait</a></li>
        <li><a href="information.html">Informations</a></li>
        <li><a href="#" id="logout">Déconnexion</a></li>
    </ul>
</div>

<h1>Retrait Cryptomonnaie</h1>

<!-- FORMULAIRE RETRAIT -->
<form id="withdraw-form">
    <div>
        <label>Montant à retirer (USD)</label>
        <input type="number" id="withdrawAmount" min="1" value="100">
    </div>
    <div>
        <label>Méthode de paiement</label>
        <select id="paymentMethod">
            <option value="Mvola">Mvola</option>
            <option value="Orange Money">Orange Money</option>
            <option value="Airtel Money">Airtel Money</option>
            <option value="Carte Bancaire">Carte Bancaire</option>
        </select>
    </div>
    <button type="button" onclick="genererFacture()">Générer Facture</button>
</form>

<!-- FACTURE -->
<div class="facture" id="facture" style="display:none;">
    <h2>FACTURE DE RETRAIT</h2>
    <div class="info">
        <p><strong>Date et Heure :</strong> <span id="dateHeure"></span></p>
        <p><strong>Nom du Client :</strong> <span id="nomClient">Utilisateur</span></p>
        <p><strong>Méthode de Paiement :</strong> <span id="methodePaiement">Mvola</span></p>
        <div class="payment-method" id="logoPaiement">
            <img src="" alt="Logo">
        </div>
        <p><strong>Numéro :</strong> <span id="numeroPaiement">+261000000000</span></p>
    </div>
    <div class="details">
        <p>Montant Retiré : <span id="montantUSD">0 USD</span></p>
        <p>Taux de Conversion : <span id="tauxConversion">1 USD = 4800 MGA</span></p>
        <p>Montant en Ariary : <span id="montantMGA">0 MGA</span></p>
    </div>
    <div class="footer">Merci de votre confiance !</div>
</div>

<!-- MINI CHATBOT -->
<div id="chatbot">
    <div class="messages" id="chatMessages">
        <p><em>Bot :</em> Bonjour ! Je peux t'aider avec ton retrait.</p>
    </div>
    <input type="text" id="chatInput" placeholder="Pose ta question...">
    <button onclick="sendMessage()">Envoyer</button>
</div>

<script>
// Vérifier utilisateur connecté
const currentUser = JSON.parse(localStorage.getItem("currentUser"));
if(!currentUser){ window.location.href="index.html"; }
document.getElementById("nomClient").innerText = currentUser.username || "Utilisateur";

// Logout
document.getElementById("logout").addEventListener("click", ()=>{
    localStorage.removeItem("currentUser");
    window.location.href="index.html";
});

// Générer facture
function genererFacture(){
    const montant = document.getElementById("withdrawAmount").value || 0;
    const method = document.getElementById("paymentMethod").value;

    // Montant & conversion
    const taux = 4800;
    document.getElementById("montantUSD").innerText = montant + " USD";
    document.getElementById("tauxConversion").innerText = `1 USD = ${taux} MGA`;
    document.getElementById("montantMGA").innerText = `${montant*taux} MGA`;

    // Date et heure
    document.getElementById("dateHeure").innerText = new Date().toLocaleString();

    // Méthode de paiement
    const methodeSpan = document.getElementById("methodePaiement");
    const logoDiv = document.getElementById("logoPaiement");
    const numeroSpan = document.getElementById("numeroPaiement");
    let logoUrl="", numero="+261000000000";
    switch(method){
        case "Mvola": logoUrl="https://upload.wikimedia.org/wikipedia/commons/2/2e/M-vola_logo.png"; numero="+261348876509"; break;
        case "Orange Money": logoUrl="https://upload.wikimedia.org/wikipedia/commons/1/11/Orange_Money_logo.png"; numero="+261339876543"; break;
        case "Airtel Money": logoUrl="https://upload.wikimedia.org/wikipedia/commons/e/e5/Airtel_Money_logo.png"; numero="+261330123456"; break;
        case "Carte Bancaire": logoUrl=""; numero="**** **** **** 1234"; break;
    }
    methodeSpan.innerText = method;
    logoDiv.innerHTML = logoUrl ? `<img src="${logoUrl}" alt="${method}">` : "";
    numeroSpan.innerText = numero;

    document.getElementById("facture").style.display="block";
}

// Mini chatbot simple
function sendMessage(){
    const input = document.getElementById("chatInput");
    const message = input.value.trim();
    if(!message) return;
    const chat = document.getElementById("chatMessages");

    // Afficher message utilisateur
    chat.innerHTML += `<p><strong>Vous :</strong> ${message}</p>`;

    // Réponse simple automatique (exemple)
    let reply = "Je ne comprends pas, peux-tu préciser ?";
    if(message.toLowerCase().includes("mvola")) reply="Pour Mvola, assure-toi d'avoir le numéro correct et le solde suffisant.";
    else if(message.toLowerCase().includes("orange")) reply="Pour Orange Money, vérifie ton réseau et le numéro saisi.";
    else if(message.toLowerCase().includes("airel") || message.toLowerCase().includes("airtel")) reply="Pour Airtel Money, assure-toi que ton compte est actif.";
    else if(message.toLowerCase().includes("banque")) reply="Pour Carte Bancaire, vérifie ton code CVV et ton solde disponible.";

    chat.innerHTML += `<p><em>Bot :</em> ${reply}</p>`;
    chat.scrollTop = chat.scrollHeight;
    input.value="";
}
</script>
</body>
</html>
